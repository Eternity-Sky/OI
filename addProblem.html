<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>添加新题</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <h2>添加新题目</h2>
        <form id="addProblemForm">
            <div class="form-group">
                <label>题号：</label>
                <input type="number" id="problemId" required>
            </div>
            <div class="form-group">
                <label>标题：</label>
                <input type="text" id="title" required>
            </div>
            <div class="form-group">
                <label>描述：</label>
                <textarea id="description" required></textarea>
            </div>
            <div class="form-group">
                <label>难度：</label>
                <select id="difficulty" required>
                    <option value="简单">简单</option>
                    <option value="中等">中等</option>
                    <option value="困难">困难</option>
                </select>
            </div>
            <div class="form-group">
                <label>标签（用逗号分隔）：</label>
                <input type="text" id="tags">
            </div>
            <div class="form-group">
                <label>输入格式：</label>
                <textarea id="input" required></textarea>
            </div>
            <div class="form-group">
                <label>输出格式：</label>
                <textarea id="output" required></textarea>
            </div>
            <div class="form-group">
                <label>样例输入：</label>
                <textarea id="sampleInput" required></textarea>
            </div>
            <div class="form-group">
                <label>样例输出：</label>
                <textarea id="sampleOutput" required></textarea>
            </div>
            <button type="submit" class="submit-btn">添加题目</button>
        </form>
        <div class="footer">
            <a href="index.html" class="back-button">返回首页</a>
        </div>
    </div>

    <script>
        document.getElementById('addProblemForm').onsubmit = (e) => {
            e.preventDefault();
            
            // 检查是否是管理员
            const currentUser = localStorage.getItem('currentUser');
            if (currentUser !== 'kkks403') {
                alert('没有权限');
                return;
            }

            // 使用用户输入的题号
            const problemId = parseInt(document.getElementById('problemId').value);

            // 检查题号是否已存在
            const problems = JSON.parse(localStorage.getItem('problems') || '[]');
            if (problems.some(p => p.id === problemId)) {
                alert('该题号已存在！');
                return;
            }

            // 创建新题目
            const newProblem = {
                id: problemId,
                title: document.getElementById('title').value,
                description: document.getElementById('description').value,
                difficulty: document.getElementById('difficulty').value,
                tags: document.getElementById('tags').value.split(',').map(tag => tag.trim()),
                input: document.getElementById('input').value,
                output: document.getElementById('output').value,
                sample_input: document.getElementById('sampleInput').value,
                sample_output: document.getElementById('sampleOutput').value,
                timeLimit: "1.0秒",
                memoryLimit: "512 MiB"
            };

            // 添加到题目列表
            problems.push(newProblem);
            // 按题号排序
            problems.sort((a, b) => a.id - b.id);
            localStorage.setItem('problems', JSON.stringify(problems));

            alert('题目添加成功！');
            window.location.href = 'index.html';
        };
    </script>
</body>
</html> 